'use strict';var _config=require("../config");describe('config',function(){test('single layer, default profile',function(){var testConfiguration={config1:{a:1}};var layer=(0,_config.define)(testConfiguration);layer.init();expect(layer.config1).toEqual({a:1});});test('three layers, one feature, one profile',function(){var layerOneConfig={config1:{a:1,b:2,profiles:{dev:{a:5,b:6}}}};var layerTwoConfig={config1:{b:3}};var layerThreeConfig={config1:{profiles:{dev:{b:10}}}};var expectedConfig={a:5,b:10};var rootLayer=(0,_config.define)(layerOneConfig);var layer1=rootLayer.define(layerTwoConfig);var layer2=layer1.define(layerThreeConfig);layer2.init(['dev']);expect(rootLayer.config1).toEqual(expectedConfig);expect(layer1.config1).toEqual(expectedConfig);expect(layer2.config1).toEqual(expectedConfig);});test('one layer, one feature, multiple profiles',function(){var config={config1:{a:1,b:2,c:15,profiles:{dev:{a:5,b:6},prod:{b:10},android:{a:6,b:7},ios:{b:11}}}};var expectedConfig={a:6,b:10,c:15};var rootLayer=(0,_config.define)(config);rootLayer.init(['prod','android']);expect(rootLayer.config1).toEqual(expectedConfig);});test('two layers, single feature, two profiles',function(){var layerOneConfig={config1:{a:1,b:2,c:3,profiles:{prod:{b:6},ios:{b:7},android:{a:8}}}};var layerTwoConfig={config1:{a:10,b:11,profiles:{dev:{b:14},prod:{a:15},ios:{a:16},android:{b:17}}}};var expectedConfig={a:16,b:14,c:3};var rootLayer=(0,_config.define)(layerOneConfig);var layer1=rootLayer.define(layerTwoConfig);layer1.init(['dev','ios']);expect(rootLayer.config1).toEqual(expectedConfig);expect(layer1.config1).toEqual(expectedConfig);});test('two features',function(){var layerOneConfig={config1:{a:1,b:2,c:3,profiles:{prod:{b:6},ios:{b:7},android:{a:8}}}};var layerTwoConfig={config1:{a:10,b:11,profiles:{dev:{b:14},prod:{a:15},ios:{a:16},android:{b:17}}},config2:{c:5,profiles:{dev:{c:10},prod:{c:1},ios:{c:2},android:{c:3}}}};var expectedConfig1={a:16,b:14,c:3};var expectedConfig2={c:10};var layer1=(0,_config.define)(layerOneConfig);var layer2=layer1.define(layerTwoConfig);layer2.init(['dev','ios']);expect(layer1.config1).toEqual(expectedConfig1);expect(layer2.config1).toEqual(expectedConfig1);expect(layer1.config2).toEqual(expectedConfig2);expect(layer2.config2).toEqual(expectedConfig2);});test('throw on multiple init',function(){var layerOneConfig={config1:{a:1,b:2,c:3,profiles:{prod:{b:6},ios:{b:7},android:{a:8}}}};var layerTwoConfig={config1:{a:10,b:11,profiles:{dev:{b:14},prod:{a:15},ios:{a:16},android:{b:17}}},config2:{c:5,profiles:{dev:{c:10},prod:{c:1},ios:{c:2},android:{c:3}}}};var layer1=(0,_config.define)(layerOneConfig);var layer2=layer1.define(layerTwoConfig);layer2.init(['dev','ios']);expect(function(){layer2.init();}).toThrow();expect(function(){layer1.init();}).toThrow();});test('check if config is immutable',function(){var layerOneConfig={config1:{a:1,b:2,c:3,profiles:{prod:{b:6},ios:{b:7},android:{a:8}}}};var layerTwoConfig={config1:{a:10,b:11,profiles:{dev:{b:14},prod:{a:15},ios:{a:16},android:{b:17}}},config2:{c:5,profiles:{dev:{c:10},prod:{c:1},ios:{c:2},android:{c:3}}}};var layer1=(0,_config.define)(layerOneConfig);var layer2=layer1.define(layerTwoConfig);layer2.init(['dev','ios']);expect(function(){layer1.config1='override value';}).toThrow();expect(function(){layer1.config1.c='override value';}).toThrow();});});